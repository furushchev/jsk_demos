<launch>
  <arg name="sensor_frame_id" default="head_mount_kinect_rgb_optical_frame" />

  <arg name="machine" default="external" />

  <include file="$(find jsk_2017_home_butler)/pr2.machine" />

  <group ns="aggregator">
    <node name="aggregator"
          pkg="jsk_2017_home_butler" type="annotation_aggregator.py"
          output="screen"
          machine="$(arg machine)">
      <remap from="~input/pose/pose" to="/ssd/bounding_box_pose/output" />
      <remap from="~input/pose/class0" to="/ssd/ssd_object_detector/output/class" />
      <remap from="~input/bbox/bbox" to="/tabletop/euclidean_clustering_decomposer/boxes"/>
      <remap from="~input/bbox/class0" to="/tabletop/color_histogram_classifier/output" />
      <remap from="~input/bbox/class1" to="/tabletop/primitive_shape_classifier/output" />
      <remap from="~input/bbox/class2" to="/tabletop/volume_classifier/output" />
      <rosparam subst_value="true">
        approximate_sync: false
        queue_size: 300
        slop: 0.3
        cache_duration: 10.0
        fixed_frame_id: $(arg sensor_frame_id)
        pose_tolerance: 0.06
        pose_annotators_num: 1
        bbox_annotators_num: 3
      </rosparam>
    </node>
    <node name="aggregator_vis"
          pkg="jsk_rviz_plugins" type="classification_result_visualizer.py"
          machine="$(arg machine)">
      <remap from="~input/boxes" to="aggregator/output/boxes" />
      <remap from="~input/classes" to="aggregator/output/class" />
      <rosparam>
        text_color_red: 1.0
        text_color_green: 0.0
        text_color_blue: 0.0
        text_offset_y: -0.12
        text_size: 0.05
      </rosparam>
    </node>
  </group>
</launch>
